<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets CRUD</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
        }
        th {
            background-color: #e9f08b;
            color: rgb(33, 31, 31);
        }
        .btn {
            padding: 8px 12px;
            margin: 5px;
            border: none;
            cursor: pointer;
        }
        .btn-insert { background-color: #e8ed4b; color: white; }
        .btn-update { background-color: #ffc107; color: black; }
        .btn-delete { background-color: #dc3545; color: white; }
    </style>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>Google Sheets Data</h2>
<table border="1" id="data-table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Date</th>
            <th>Time</th>
            <th>Shift</th>
            <th>First Prize Winnner</th>
            <th>2nd Prize Winnner- 1</th>
            <th>2nd Prize Winnner-2</th>
            <th>2nd Prize Winnner-3</th>
            <th>2nd Prize Winnner-4</th>
            <th>2nd Prize Winnner-5</th>
            <th>2nd Prize Winnner-6</th>
            <th>2nd Prize Winnner-7</th>
            <th>2nd Prize Winnner-8</th>
            <th>2nd Prize Winnner-9</th>
            <th>2nd Prize Winnner-10</th>
            <th>3rd Prize Winnner-1</th>
            <th>3rd Prize Winnner-2</th>
            <th>3rd Prize Winnner-3</th>
            <th>3rd Prize Winnner-4</th>
            <th>3rd Prize Winnner-5</th>
            <th>3rd Prize Winnner-6</th>
            <th>3rd Prize Winnner-7</th>
            <th>3rd Prize Winnner-8</th>
            <th>3rd Prize Winnner-9</th>
            <th>3rd Prize Winnner-10</th>
            <th>4th Prize Winnner-1</th>
            <th>4th Prize Winnner-2</th>
            <th>4th Prize Winnner-3</th>
            <th>4th Prize Winnner-4</th>
            <th>4th Prize Winnner-5</th>
            <th>4th Prize Winnner-6</th>
            <th>4th Prize Winnner-7</th>
            <th>4th Prize Winnner-8</th>
            <th>4th Prize Winnner-9</th>
            <th>4th Prize Winnner-10</th>
            <th>5th Prize Winnner-00</th>
            <th>5th Prize Winnner-01</th>
            <th>5th Prize Winnner-02</th>
            <th>5th Prize Winnner-03</th>
            <th>5th Prize Winnner-04</th>
            <th>5th Prize Winnner-05</th>
            <th>5th Prize Winnner-06</th>
            <th>5th Prize Winnner-07</th>
            <th>5th Prize Winnner-08</th>
            <th>5th Prize Winnner-09</th>
            <th>5th Prize Winnner-10</th>
            <th>5th Prize Winnner-11</th>
            <th>5th Prize Winnner-12</th>
            <th>5th Prize Winnner-13</th>
            <th>5th Prize Winnner-14</th>
            <th>5th Prize Winnner-15</th>
            <th>5th Prize Winnner-16</th>
            <th>5th Prize Winnner-17</th>
            <th>5th Prize Winnner-18</th>
            <th>5th Prize Winnner-19</th>
            <th>5th Prize Winnner-20</th>
            <th>5th Prize Winnner-21</th>
            <th>5th Prize Winnner-22</th>
            <th>5th Prize Winnner-23</th>
            <th>5th Prize Winnner-24</th>
            <th>5th Prize Winnner-25</th>
            <th>5th Prize Winnner-26</th>
            <th>5th Prize Winnner-27</th>
            <th>5th Prize Winnner-28</th>
            <th>5th Prize Winnner-29</th>
            <th>5th Prize Winnner-30</th>
            <th>5th Prize Winnner-31</th>
            <th>5th Prize Winnner-32</th>
            <th>5th Prize Winnner-33</th>
            <th>5th Prize Winnner-34</th>
            <th>5th Prize Winnner-35</th>
            <th>5th Prize Winnner-36</th>
            <th>5th Prize Winnner-37</th>
            <th>5th Prize Winnner-38</th>
            <th>5th Prize Winnner-39</th>
            <th>5th Prize Winnner-40</th>
            <th>5th Prize Winnner-41</th>
            <th>5th Prize Winnner-42</th>
            <th>5th Prize Winnner-43</th>
            <th>5th Prize Winnner-44</th>
            <th>5th Prize Winnner-45</th>
            <th>5th Prize Winnner-46</th>
            <th>5th Prize Winnner-47</th>	
            <th>5th Prize Winnner-48</th>
            <th>5th Prize Winnner-49</th>
            <th>5th Prize Winnner-50</th>
            <th>5th Prize Winnner-51</th>
            <th>5th Prize Winnner-52</th>
            <th>5th Prize Winnner-53</th>	
            <th>5th Prize Winnner-54</th>	
            <th>5th Prize Winnner-55</th>	
            <th>5th Prize Winnner-56</th>	
            <th>5th Prize Winnner-57</th>	
            <th>5th Prize Winnner-58</th>	
            <th>5th Prize Winnner-59</th>	
            <th>5th Prize Winnner-60</th>	
            <th>5th Prize Winnner-61</th>
            <th>5th Prize Winnner-62</th>
            <th>5th Prize Winnner-63</th>
            <th>5th Prize Winnner-64</th>
            <th>5th Prize Winnner-65</th>
            <th>5th Prize Winnner-66</th>
            <th>5th Prize Winnner-67</th>
            <th>5th Prize Winnner-68</th>	
            <th>5th Prize Winnner-69</th>	
            <th>5th Prize Winnner-70</th>	
            <th>5th Prize Winnner-71</th>	
            <th>5th Prize Winnner-72</th>	
            <th>5th Prize Winnner-73</th>	
            <th>5th Prize Winnner-74</th>	
            <th>5th Prize Winnner-75</th>	
            <th>5th Prize Winnner-76</th>	
            <th>5th Prize Winnner-77</th>	
            <th>5th Prize Winnner-78</th>	
            <th>5th Prize Winnner-79</th>	
            <th>5th Prize Winnner-80</th>	
            <th>5th Prize Winnner-81</th>	
            <th>5th Prize Winnner-82</th>	
            <th>5th Prize Winnner-83</th>	
            <th>5th Prize Winnner-84</th>	
            <th>5th Prize Winnner-85</th>	
            <th>5th Prize Winnner-86</th>	
            <th>5th Prize Winnner-87</th>	
            <th>5th Prize Winnner-88</th>	
            <th>5th Prize Winnner-89</th>	
            <th>5th Prize Winnner-90</th>	
            <th>5th Prize Winnner-91</th>	
            <th>5th Prize Winnner-92</th>	
            <th>5th Prize Winnner-93</th>	
            <th>5th Prize Winnner-94</th>	
            <th>5th Prize Winnner-95</th>	
            <th>5th Prize Winnner-96</th>	
            <th>5th Prize Winnner-97</th>	
            <th>5th Prize Winnner-98</th>	
            <th>5th Prize Winnner-99</th>	
            <th>5th Prize Winnner-100</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>
<div class="divisation">
    <div class="container">

<h3>Add/Edit Data</h3>
<form id="data-form">
    <input type="hidden" id="id">
    <!-- <input type="text" id="shift" placeholder="Shift" required>
    <input type="number" id="value1" placeholder="Value 1" required>
    <input type="number" id="value2" placeholder="Value 2" required>
    <input type="number" id="value3" placeholder="Value 3" required> -->
    <div class="select">
        <label for="selectShift">Select Shift</label>
        <select name="selectShift" id="shift" required>
            <option hidden>Select Shift</option>
            <option value="First Shift 1pm">First Shift 1pm</option>
            <option value="Second Shift 6pm">Second Shift 6pm</option>
            <option value="Third Shift 8pm">Third Shift 8pm</option>
        </select>
    </div>
    <div class="input-box">
        <label for="1st Prize Winnner">1st Prize Winnner</label>
        <input type="number" id="value1" name="1stPrizeWinnner" required>
    </div>
    <div class="row">
        <div class="input-group">
            <label for="2st Prize-1">2nd Prize</label>
            <input type="number" id="value2" name="2stPrize-1" required>
        </div>
        <div class="input-group">
            <label for="2nd-2">2nd-2</label>
            <input type="number" id="value3" name="2nd-2" required>
        </div>
        <div class="input-group">
            <label for="2nd-3">2nd-3</label>
            <input type="number" id="value4" name="2nd-3" required>
        </div>
        <div class="input-group">
            <label for="2nd-4">2nd-4</label>
            <input type="number" id="value5" name="2nd-4" required>
        </div>
        <div class="input-group">
            <label for="2nd-5">2nd-5</label>
            <input type="number" id="value6" name="2nd-5" required>
        </div>
        <div class="input-group">
            <label for="2nd-6">2nd-6</label>
            <input type="number" id="value7" name="2nd-6" required>
        </div>
        <div class="input-group">
            <label for="2nd-7">2nd-7</label>
            <input type="number" id="value8" name="2nd-7" required>
        </div>
        <div class="input-group">
            <label for="2nd-8">2nd-8</label>
            <input type="number" id="value9" name="2nd-8" required>
        </div>
        <div class="input-group">
            <label for="2nd-9">2nd-9</label>
            <input type="number" id="value10" name="2nd-9" required>
        </div>
        <div class="input-group">
            <label for="2nd-10">2nd-10</label>
            <input type="number" id="value11" name="2nd-10" required>
        </div>
    </div>
    <div class="row">
        <div class="input-group">
            <label for="3rd Prize">3rd Prize</label>
            <input type="number" id="value12" name="3rdPrize" required>
        </div>
        <div class="input-group">
            <label for="3rd-2">3rd-2</label>
            <input type="number" id="value13" name="3rd-2" required>
        </div>
        <div class="input-group">
            <label for="3rd-3">3rd-3</label>
            <input type="number" id="value14" name="3rd-3" required>
        </div>
        <div class="input-group">
            <label for="3rd-4">3rd-4</label>
            <input type="number" id="value15" name="3rd-4" required>
        </div>
        <div class="input-group">
            <label for="3rd-5">3rd-5</label>
            <input type="number" id="value16" name="3rd-5" required>
        </div>
        <div class="input-group">
            <label for="3rd-6">3rd-6</label>
            <input type="number" id="value17" name="3rd-6" required>
        </div>
        <div class="input-group">
            <label for="3rd-7">3rd-7</label>
            <input type="number" id="value18" name="3rd-7" required>
        </div>
        <div class="input-group">
            <label for="3rd-8">3rd-8</label>
            <input type="number" id="value19" name="3rd-8" required>
        </div>
        <div class="input-group">
            <label for="3rd-9">3rd-9</label>
            <input type="number" id="value20" name="3rd-9" required>
        </div>
        <div class="input-group">
            <label for="3rd-10">3rd-10</label>
            <input type="number" id="value21" name="3rd-10" required>
        </div>
    </div>
    <div class="row">
        <div class="input-group">
            <label for="4th Prize">4th Prize</label>
            <input type="number" id="4thPrize" name="4thPrize" required>
        </div>
        <div class="input-group">
            <label for="4th-2">4th-2</label>
            <input type="number" id="4th-2" name="4th-2" required>
        </div>
        <div class="input-group">
            <label for="4th-3">4th-3</label>
            <input type="number" id="4th-3" name="4th-3" required>
        </div>
        <div class="input-group">
            <label for="4th-4">4th-4</label>
            <input type="number" id="4th-4" name="4th-4" required>
        </div>
        <div class="input-group">
            <label for="4th-5">4th-5</label>
            <input type="number" id="4th-5" name="4th-5" required>
        </div>
        <div class="input-group">
            <label for="4th-6">4th-6</label>
            <input type="number" id="4th-6" name="4th-6" required>
        </div>
        <div class="input-group">
            <label for="4th-7">4th-7</label>
            <input type="number" id="4th-7" name="4th-7" required>
        </div>
        <div class="input-group">
            <label for="4th-8">4th-8</label>
            <input type="number" id="4th-8" name="4th-8" required>
        </div>
        <div class="input-group">
            <label for="4th-9">4th-9</label>
            <input type="number" id="4th-9" name="4th-9" required>
        </div>
        <div class="input-group">
            <label for="4th-10">4th-10</label>
            <input type="number" id="4th-10" name="4th-10" required>
        </div>
    </div>
    <button class="button" type="submit">Update</button>
</form>
</div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwnKuJ1jOf_6cHrBi8gzxNOGWAr6sn9WeXWr4yYFROTvX5UI-NOjaInWilKdnF0W1Io/exec";

// Fetch and display data
function loadData() {
    fetch(API_URL)
        .then(response => response.json())
        .then(data => {
            const tbody = document.querySelector("#data-table tbody");
            tbody.innerHTML = "";
            data.forEach(row => {
                tbody.innerHTML += `
                    <tr>
                        <td>${row.id}</td>
                        <td>${row.date}</td>
                        <td>${row.time}</td>
                        <td>${row.selectShift}</td>
                        <td>${row.value1}</td>
                        <td>${row.value2}</td>
                        <td>${row.value3}</td>
                        <td>${row.value4}</td>
                        <td>${row.value5}</td>
                        <td>${row.value6}</td>
                        <td>${row.value7}</td>
                        <td>${row.value8}</td>
                        <td>${row.value9}</td>
                        <td>${row.value10}</td>
                        <td>${row.value11}</td>
                        <td>${row.value12}</td>
                        <td>${row.value13}</td>
                        <td>${row.value14}</td>
                        <td>
                            <button onclick="editData(${row.id}, '${row.selectShift}', ${row.value1}, ${row.value2}, ${row.value3},${row.value4},${row.value5},${row.value6},${row.value7},${row.value8},${row.value9},${row.value10},${row.value11},${row.value12},${row.value13},${row.value14})">Edit</button>
                            <button onclick="deleteData(${row.id})">Delete</button>
                        </td>
                    </tr>
                `;
            });
        });
}
                        
// Insert or Update data
document.querySelector("#data-form").addEventListener("submit", function (e) {
    e.preventDefault();
    const id = document.querySelector("#id").value;
    const selectShift = document.querySelector("#shift").value;
    const value1 = document.querySelector("#value1").value;
    const value2 = document.querySelector("#value2").value;
    const value3 = document.querySelector("#value3").value;
    const value4 = document.querySelector("#value4").value;
    const value5 = document.querySelector("#value5").value;
    const value6 = document.querySelector("#value6").value;
    const value7 = document.querySelector("#value7").value;
    const value8 = document.querySelector("#value8").value;
    const value9 = document.querySelector("#value9").value;
    const value10 = document.querySelector("#value10").value;
    const value11 = document.querySelector("#value11").value;
    const value12 = document.querySelector("#value12").value;
    
    const action = id ? "update" : "insert";
    fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({ action, id, selectShift, value1, value2, value3,value4,value5,value6,value7,value8,value9,value10,value11,value12 })
    }).then(response => response.text())
      .then(() => {
          loadData();
          document.querySelector("#data-form").reset();
          alert("Data Update Successfully");
      });
});

// Edit data (populate form)
function editData(id, shift, value1, value2, value3,value4,value5,value6,value7,value8,value9,value10,value11,value12) {
    document.querySelector("#id").value = id;
    document.querySelector("#shift").value = shift;
    document.querySelector("#value1").value = value1;
    document.querySelector("#value2").value = value2;
    document.querySelector("#value3").value = value3;
    document.querySelector("#value4").value = value4;
    document.querySelector("#value5").value = value5;
    document.querySelector("#value6").value = value6;
    document.querySelector("#value7").value = value7;
    document.querySelector("#value8").value = value8;
    document.querySelector("#value9").value = value9;
    document.querySelector("#value10").value = value10;
    document.querySelector("#value11").value = value11;
    document.querySelector("#value12").value = value12;
    document.querySelector("#value13").value = value13;
    document.querySelector("#value14").value = value14;
}

// Delete data
function deleteData(id) {
    fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({ action: "delete", id })
    }).then(response => response.text())
      .then(() => loadData());
      alert("Data Deleted Successfully");
}

// Load data on page load
loadData();
</script>

</body>
</html>